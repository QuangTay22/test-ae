<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Vũ Trụ Tình Yêu</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: black;
      overflow: hidden;
      height: 100vh;
      font-family: 'Segoe UI', sans-serif;
      perspective: 1600px; /* Tăng để 3D sâu hơn */
      cursor: grab;
      color: white;
    }
    .scene {
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      position: relative;
    }
    .star {
      position: fixed;
      background: white;
      border-radius: 50%;
      opacity: 0.8;
      animation: twinkle 2s infinite ease-in-out;
      z-index: -1;
    }
    @keyframes twinkle {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 1; }
    }
    .heart, .love-text, .floating-img {
      position: absolute;
      transform-style: preserve-3d;
      animation: floatUp 14s linear infinite;
      opacity: 0.9;
      z-index: 1;
    }
    .heart svg {
      width: 100%;
      height: 100%;
      filter: drop-shadow(0 0 8px red) drop-shadow(0 0 15px red);
    }
    .love-text {
      font-size: 1.5rem;
      font-weight: bold;
      white-space: nowrap;
      text-shadow: 0 0 10px cyan, 0 0 20px cyan;
    }
    .floating-img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 10px;
      box-shadow: 0 0 10px white;
    }
    @keyframes floatUp {
      0% { transform: translate3d(0, 100vh, -200px) scale(1); opacity: 1; }
      100% { transform: translate3d(0, -150vh, 1000px) scale(1.3); opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="scene" id="scene"></div>
  <script>
const scene = document.getElementById("scene");

// tạo sao
for (let i = 0; i < 200; i++) {
  const star = document.createElement("div");
  star.className = "star";
  const size = Math.random() * 2 + 1;
  star.style.width = size + "px";
  star.style.height = size + "px";
  star.style.left = Math.random() * 100 + "vw";
  star.style.top = Math.random() * 100 + "vh";
  document.body.appendChild(star);
}

// lấy dữ liệu từ URL
const params = new URLSearchParams(window.location.search);

// text
const texts = [];
for (let i = 1; i <= 5; i++) {
  const val = params.get("text" + i);
  if (val) texts.push(decodeURIComponent(val));
}

// ảnh
let images = [];
if (params.get("imgs")) {
  try {
    images = JSON.parse(decodeURIComponent(params.get("imgs")));
  } catch (e) {
    images = [];
  }
}

// nhạc
const music = params.get("music");
if (music) {
  const audio = document.createElement("audio");
  audio.src = decodeURIComponent(music);
  audio.autoplay = true;
  audio.loop = true;
  document.body.appendChild(audio);
}

function createHeart(layer) {
  const wrapper = document.createElement("div");
  wrapper.className = "heart";
  wrapper.style.width = "40px";
  wrapper.style.height = "40px";
  wrapper.style.left = (Math.random() * 120 - 10) + "vw";
  wrapper.style.top = (Math.random() * 140 - 20) + "vh";
  wrapper.style.animation = `floatUp ${8 + layer * 2}s linear infinite`;
  wrapper.style.transform = `scale(${0.5 + layer * 0.25}) translateZ(${(layer - 3) * 400 + (Math.random() * 400 - 200)}px)`;
  wrapper.style.opacity = 0.5 + layer * 0.1;
  wrapper.innerHTML = `
    <svg viewBox="0 0 32 29.6" xmlns="http://www.w3.org/2000/svg">
      <path d="M23.6,0c-3.4,0-6.4,2.1-7.6,5.2
               C14.8,2.1,11.8,0,8.4,0
               C3.8,0,0,3.8,0,8.4
               c0,9.3,16,21.2,16,21.2
               s16-11.9,16-21.2
               C32,3.8,28.2,0,23.6,0z" fill="red"/>
    </svg>`;
  scene.appendChild(wrapper);
  setTimeout(() => wrapper.remove(), 16000);
}

function createText(layer) {
  if (texts.length === 0) return;
  const text = document.createElement("div");
  text.className = "love-text";
  text.textContent = texts[Math.floor(Math.random() * texts.length)];
  text.style.left = (Math.random() * 120 - 10) + "vw";
  text.style.top = (Math.random() * 140 - 20) + "vh";
  text.style.color = `hsl(${Math.random() * 360}, 100%, 80%)`;
  text.style.animationDuration = `${6 + layer * 2}s`;
  text.style.transform = `scale(${0.5 + layer * 0.25}) translateZ(${(layer - 3) * 400 + (Math.random() * 400 - 200)}px)`;
  text.style.opacity = 0.5 + layer * 0.1;
  scene.appendChild(text);
  setTimeout(() => text.remove(), 16000);
}

function createImage(layer) {
  if (images.length === 0) return;
  const img = document.createElement("img");
  img.className = "floating-img";
  img.src = images[Math.floor(Math.random() * images.length)];
  img.style.left = (Math.random() * 120 - 10) + "vw";
  img.style.top = (Math.random() * 140 - 20) + "vh";
  img.style.animationDuration = `${6 + layer * 2}s`;
  img.style.transform = `scale(${0.5 + layer * 0.25}) translateZ(${(layer - 3) * 400 + (Math.random() * 400 - 200)}px)`;
  img.style.opacity = 0.5 + layer * 0.1;
  scene.appendChild(img);
  setTimeout(() => img.remove(), 16000);
}

// nhiều lớp hơn
setInterval(() => {
  for (let layer = 1; layer <= 6; layer++) {
    createHeart(layer);
    createText(layer);
    createImage(layer);
  }
}, 400);

// xoay 3D
let rotateX = 10, rotateY = 0;
let dragging = false, startX, startY;
document.body.addEventListener("mousedown", e => {
  dragging = true;
  startX = e.clientX; startY = e.clientY;
  document.body.style.cursor = "grabbing";
});
document.body.addEventListener("mouseup", () => {
  dragging = false;
  document.body.style.cursor = "grab";
});
document.body.addEventListener("mousemove", e => {
  if (!dragging) return;
  const deltaX = e.clientX - startX;
  const deltaY = e.clientY - startY;
  rotateY += deltaX * 0.3;
  rotateX -= deltaY * 0.3;
  rotateX = Math.max(-90, Math.min(90, rotateX));
  scene.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
  startX = e.clientX; startY = e.clientY;
});
</script>
</body>
</html>
